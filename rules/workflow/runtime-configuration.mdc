---
description: Runtime environment configuration, container management, and dependency standards for local development. This rule establishes environment expectations for dependency isolation, configuration management, Docker/Supabase container usage, and MCP server loadout. Agents must use strict isolation (local node_modules/.venv), all config from .env or database (no hardcoded values), use project-specific commands for containers, and always use start_app.sh for launching.
version: 2.1.0
created: 12-04-2025
lastUpdated: 12-08-2025 10:00:00 EST
alwaysApply: false
globs:
type: Environment Configuration Rule - Runtime and dependency standards
applicability: All development environments
dependencies: []
relatedCommands: [[create-start-scripts.md]]
relatedRules: [[auto-heal.mdc], [task-workflow.mdc], [../core/date-time.mdc], [../core/version-management.mdc]]
relatedStandards: [[architecture/supabase-local-setup.md], [deployment/application-launch.md]]
---

# Runtime Configuration & Environment Standards

## 1. Runtime Expectations

This project operates in a "Container-Like" local environment.
- **Strict Isolation:** Dependencies must be local (`node_modules`, `.venv`). Do not rely on global system packages.
- **Configuration:** All config comes from `.env` or the database. Hardcoded ports/URLs are forbidden.
- **Launch:** Always use `./start_app.sh` to start the app. If `start_app.sh` doesn't exist, run the `create-start-scripts` command (`.cursor/commands/create-start-scripts.md`) to generate it.

## 2. Local Docker Dev Environment

### 2.1 Docker Compose Projects

If `docker-compose.yml` is present:
1. **Prefer Docker:** Use Docker for databases (Postgres, Redis) and infrastructure.
2. **Hybrid App:** Run the *application code* locally (Node/Python) for faster HMR, but connect to *Dockerized services*.
3. **Logs:** View container logs via Docker Desktop or `docker logs`.

### 2.2 Supabase Local Development

If `supabase/` directory is present:
1. **Use Supabase CLI:** Always use `supabase start/stop/status` commands for container management.
2. **Container Isolation (CRITICAL):** Only affect containers belonging to the current project.
   - ✅ Use `supabase start` - Starts only current project's containers
   - ✅ Use `supabase stop` - Stops only current project's containers
   - ❌ Never use `docker stop $(docker ps -q)` - This affects ALL containers across all projects
3. **Setup:** See `standards/architecture/supabase-local-setup.md` for complete installation and configuration guide.
4. **Environment Variables:** Retrieve local credentials with `supabase status` and configure in `.env.local`.

## 3. MCP Loadout Instructions

Ensure the following MCP servers are active if relevant:
- **Supabase:** For database inspection and edge function management.
- **Postgres:** For direct SQL execution if Supabase MCP is unavailable.
- **Notion:** For project and task management integration (required if Notion Project Binding rule exists).
- **Filesystem:** For reading/writing local files (standard).

## 4. Dependency Management

- **Node:** Use `npm` (default), `yarn`, or `pnpm` based on lockfile presence.
- **Python:** Always use a virtual environment.
- **Lockfiles:** Never delete lockfiles to "fix" errors. Fix the dependency conflict instead.

## 5. Container Management Rules (CRITICAL)

When working with Docker or Supabase containers in multi-project environments:

1. **Project-Specific Commands:**
   - Always use project-specific commands (`supabase start/stop` for Supabase, filtered Docker commands for other services).
   - Never use broad commands that affect all containers.

2. **Container Identification:**
   - For Supabase: Use `supabase status` to identify current project's containers.
   - For Docker Compose: Filter by project name or use project-specific compose files.

3. **Port Conflicts:**
   - Identify which project owns the conflicting container before stopping.
   - Only stop containers belonging to the current project.
   - If unsure, ask the user which project should use the port.

4. **Error Recovery:**
   - See `.cursor/rules/workflow/auto-heal.mdc` for detailed container management error recovery.
   - See `standards/architecture/supabase-local-setup.md` Section 10 for Supabase-specific container isolation guidelines.

---

## Related Files

- **Commands:**
  - [create-start-scripts.md](../../commands/create-start-scripts.md) - Generates application launch scripts
- **Rules:**
  - [auto-heal.mdc](./auto-heal.mdc) - Error recovery strategies including container management
  - [task-workflow.mdc](./task-workflow.mdc) - Development workflow that uses these environment standards
  - [../core/date-time.mdc](../core/date-time.mdc) - Date and time awareness for AI agents
  - [../core/version-management.mdc](../core/version-management.mdc) - Semantic versioning standards for all documentation
- **Standards:**
  - [supabase-local-setup.md](../../../standards/architecture/supabase-local-setup.md) - Supabase local setup guide
  - [application-launch.md](../../../standards/deployment/application-launch.md) - Application launch standards

---

## How to Use This Rule

**This rule applies automatically to all files in the repository.**

**Agents should:**
- Use `./start_app.sh` to launch applications (or run `create-start-scripts` if missing)
- Use project-specific commands for Docker/Supabase containers (never affect all containers)
- Ensure strict dependency isolation (use local `node_modules`, `.venv`, etc.)
- For date/time operations, see `.cursor/rules/core/date-time.mdc`
- For versioning guidance, see `.cursor/rules/core/version-management.mdc`
